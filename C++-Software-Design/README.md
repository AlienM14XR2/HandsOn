# Start at 2023-12-16

# C++ ソフトウェア設計

これもデザインパターン、設計の本。

次回からこれをやる。

久しぶりの C++ リファレンス以外の書籍になる。

# ソフトウェア設計の重要性を理解する
## ガイドライン１の要約

- ソフトウェア設計は、ソフトウェア開発の心臓部と位置づける。
- C++ 言語の細部に集中するのではなく、ソフトウェア設計に集中する。
- ソフトウェアを将来の変更に適応しやすくするために、不必要な関係性、依存関係
は設けない。
- ソフトウェア設計とは、依存関係と抽象化を管理する技だと認識する。
- ソフトウェア設計はソフトウェア・アーキテクチャの境界は固定されておらず、
流動的と考える

# 将来の変更に備え設計する
## ガイドライン２の要約

- ソフトウェアに変更はつきものと認識する。
- 将来の変更に備えた設計とし、ソフトウェアの順応性を確保する。
- 無用の関係性を排除すべく、無関係の直行するアスペクトの結合を避ける。
- 関係性が増加すると変更が連なりやすくなり、将来の変更が困難になることを理解する。
- 単一責任の原則に、関心を分離する。
- DRY 原則に従い、重複を最小限化する。
- 将来の変更が確実でなければ、時期尚早な抽象化は避ける。

# インタフェースを分離し人工的関係性を排除する
## ガイドライン３の要約

- 関係性はインタフェースにも影響する点を認識する。
- インタフェースでは ISP に従い関心を分離する。
- ISP は SRP の特殊ケースと捉える。
- ISP は継承階層にもテンプレートにも有効である点を理解する。

# テスト可用性に備え設計する
## ガイドライン４の要約

- テストは、誤って開発物件を壊してしまわないようにする、保護役であることを理解する。
- テストは必要不可欠であることを忘れてはならない。テスト可用性も同様である。
- テスト可用性を念頭に、関心を分離する。
- テストが必要な private メンバ関数とは、クラス内で宣言する場所を間違えている
とみなすべきである（フリー関数、グローバル領域に移動してしまう）。
- メンバ関数より、非メンバかつ非 friend 関数を優先する。

# 拡張に備え設計する
## ガイドライン５の要約

- コードの拡張性が容易になる設計を優先する。
- OCR に従い、拡張に対してはオープンに、改造（既存コード）に対してはクローズに、の状態を維持する。
- コードの追加には、基底クラス、テンプレート、関数オーバーロード、テンプレートの
特殊化を用いるよう設計する。
- 今後のコード追加が不明ならば早計な抽象化は避ける。

# 抽象化から期待される動作に従う
## ガイドライン６の要約

- 抽象化とは要件や期待する動作を表現するもの、と理解する。
- 抽象化が期待する動作に従うため、LSP に従う。
- 派生クラスが、基底クラスが期待する動作に従うよう保証する。
- 抽象化が期待する内容は明文化する（@see https://oreil.ly/OBpAg
）。

# 基底クラスとコンセプトの共通性を把握する
## ガイドライン７の要約

- 動的多態性（実行時に決定される）、静的多態性（コンパイル時に決定）、いずれにせよ LSP を適用する。
- コンセプトは（C++20 のコンセプトもC++20 以前のテンプレート引数名も）、基底クラス相当機能を静的に表現したものと捉える。
- テンプレートを使用する場合、コンセプトが期待する動作を満たすようにする。
- コンセプトが期待する内容を明確化する（特にC++20 以前のテンプレート引数名の場合）。
